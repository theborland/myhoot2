All available information about the device that has sent a request is stored in the user agent string of the request header. This class matches the user agent string with patterns of known user agent strings to determine the type of device.

	class UserAgentMatcher
		constructor: (@agent) ->

		matchTV: ->
			if @agent.match(///GoogleTV|SmartTV|Internet TV|NetCast|NETTV|AppleTV
				|boxee|Kylo|Roku|DLNADOC|CE\-HTML///i)
				return true
			if @agent.match /Xbox|PLAYSTATION 3|Wii/i
				return true
			return false
		matchTablet: ->
			if @agent.match /iP(a|ro)d/i
				return true
			if @agent.match(/tablet/i) and not @agent.match /RX-34/i
				return true
			if @agent.match /FOLIO/i
				return true
			if @agent.match(/Linux/i) and @agent.match(/Android/i) and not @agent.match ///
				Fennec|mobi|HTC Magic|HTCX06HT|Nexus One|SC-02B|fone 945///i
				return true
			if @agent.match /Kindle/i
				return true
			if @agent.match(/Mac OS/i) and @agent.match /Silk/i
				return true
			if @agent.match ///GT-P10|SC-01C|SHW-M180S|SGH-T849|SCH-I800|SHW-M180L
				|SPH-P100|SGH-I987|zt180|HTC( Flyer|_Flyer)|Sprint ATP51|ViewPad7
				|pandigital(sprnova|nova)|Ideos S7|Dell Streak 7|Advent Vega|A101IT
				|A70BHT|MID7015|Next2|nook///i
				return true
			if @agent.match(/MB511/i) and @agent.match /RUTEM/i
				return true
			return false
		matchDesktop: ->
			if @agent.match(/Windows (NT|XP|ME|9)/i) and not @agent.match(///
				Phone///i) and not @agent.match /Bot|Spider|ia_archiver|NewsGator/i
				return true
			if @agent.match /Win( ?9|NT)/i
				return true
			if @agent.match(/Macintosh|PowerPC/i) and not @agent.match /Silk/i
				return true
			if @agent.match(/Linux/i) and @agent.match(/X11/i) and !@agent.match ///
				Charlotte|GoogleTV///i
				return true
			if @agent.match /CrOS/i
				return true
			if @agent.match /Solaris|SunOS|BSD/i
				return true
			return false
		matchBot: ->
			if @agent.match(///curl|Bot|B-O-T|Crawler|Spider|Spyder|Yahoo|
				ia_archiver|Covario-IDS|findlinks|DataparkSearch|larbin|
				Mediapartners-Google|NG-Search|Snappy|Teoma|Jeeves|Charlotte|
				NewsGator|TinEye|Cerberian|SearchSight|Zao|Scrubby|Qseero|PycURL|
				Pompos|oegp|SBIder|yoogliFetchAgent|yacy|webcollage|VYU2|voyager|
				updated|truwoGPS|StackRambler|Sqworm|silk|semanticdiscovery|ScoutJet
				|Nymesis|NetResearchServer|MVAClient|mogimogi|Mnogosearch|Arachmo|
				Accoona|holmes|htdig|ichiro|webis|LinkWalker|lwp-trivial///i) and not @agent.match ///
				phone|Playstation///i
				return true
			return false
		matchPhone: ->
			if not @matchTV() and not @matchTablet() and not @matchDesktop() and not @matchBot()
				return true
			return false

	module.exports = UserAgentMatcher;