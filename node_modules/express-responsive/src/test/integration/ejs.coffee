request = require 'supertest'

describe 'ejs', ->
	describe 'middleware', ->
		it 'should show device template', (done) ->
			app = require './apps/ejs-middleware'
			request(app).get('/')
			.expect(200)
			.expect('Content-Type', /html/)
			.expect(/Desktop/)
			.end done
	describe 'routing', ->
		it 'should show device template', (done) ->
			app = require './apps/ejs-routing'
			request(app).get('/')
			.expect(200)
			.expect('Content-Type', /html/)
			.expect(/Desktop/)
			.end done
		it 'should fallback if no device template is available', (done) ->
			app = require './apps/ejs-routing'
			request(app).get('/fallback')
			.expect(200)
			.expect('Content-Type', /html/)
			.expect(/Fallback/)
			.end done